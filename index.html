<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- 期供变更：分类工具，禁止缩放字体，触摸优化 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no, email=no">
    <title>逾期借款人评估画像工具</title>
    <style>
        /* 全局重置，友好沟通 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', 'Roboto', 'PingFang SC', 'Microsoft YaHei', sans-serif;
        }
        body {
            background: linear-gradient(165deg, #e9f2f5 0%, #dbe9ee 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 16px;
        }
        .evaluator {
            max-width: 700px;
            width: 100%;
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(18px);
            -webkit-backdrop-filter: blur(18px);
            border-radius: 48px 48px 40px 40px;
            box-shadow: 0 25px 45px rgba(0,45,60,0.15);
            padding: 28px 24px;
            border: 1px solid rgba(255,255,255,0.6);
        }
        .app-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }
        .app-title h1 {
            font-size: 1.9rem;
            font-weight: 700;
            color: #0a3844;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .badge {
            background: #1f6e7a;
            color: white;
            padding: 6px 16px;
            border-radius: 40px;
            font-size: 0.8rem;
            font-weight: 600;
            border: 1px solid #ffffff90;
        }
        /* 滑块打分卡片 */
        .score-panel {
            background: #f7fbfd;
            border-radius: 36px;
            padding: 26px 24px;
            margin-bottom: 28px;
            box-shadow: inset 0 2px 8px rgba(0,0,0,0.02), 0 8px 18px rgba(33,80,90,0.1);
        }
        .score-item {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 24px;
        }
        .score-item:last-child {
            margin-bottom: 0;
        }
        .score-label {
            flex: 0 0 100px;
            font-weight: 600;
            color: #145c68;
            font-size: 1.08rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .slider-area {
            flex: 1 1 200px;
            display: flex;
            align-items: center;
            gap: 16px;
            flex-wrap: wrap;
        }
        /* 大触摸滑块，适合手指 */
        input[type=range] {
            flex: 1 1 160px;
            height: 46px;
            -webkit-appearance: none;
            background: transparent;
        }
        input[type=range]::-webkit-slider-runnable-track {
            height: 12px;
            background: linear-gradient(90deg, #3299aa, #5cb8c4);
            border-radius: 30px;
            border: none;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            margin-top: -10px;
            box-shadow: 0 6px 14px #146b78a0;
            border: 2.5px solid #0a5f6a;
            transition: 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:active {
            transform: scale(1.2);
            background: #f0feff;
        }
        .score-number {
            min-width: 54px;
            background: #126a75;
            color: white;
            font-weight: 700;
            padding: 10px 14px;
            border-radius: 40px;
            text-align: center;
            font-size: 1.25rem;
            line-height: 1;
            box-shadow: 0 6px 12px #0a4a5290;
            letter-spacing: 1px;
        }
        /* 结果卡片——动态改变颜色 */
        .result-card {
            background: white;
            border-radius: 32px;
            padding: 28px 24px;
            margin-bottom: 28px;
            border-left: 14px solid;
            box-shadow: 0 16px 30px rgba(20,80,90,0.12);
            transition: border-left 0.2s, background 0.2s;
        }
        .type-header {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 18px;
        }
        .type-name {
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: 1px;
        }
        .ability-tag {
            background: #1a514e;
            padding: 10px 22px;
            border-radius: 60px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
        }
        .type-desc {
            font-size: 1.1rem;
            margin-bottom: 18px;
            color: #174955;
            font-weight: 500;
        }
        .strategy-box {
            background: #eaf1f3;
            border-radius: 24px;
            padding: 20px;
            color: #094c57;
            font-size: 1rem;
            line-height: 1.55;
            border: 1px solid #bee0e6;
        }
        .strategy-box strong {
            color: #0e4e5a;
        }
        /* 象限坐标简图 + 重置区 */
        .viz-section {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 10px;
        }
        .canvas-box {
            background: white;
            border-radius: 28px;
            padding: 16px;
            box-shadow: 0 8px 16px rgba(0,55,65,0.08);
            flex: 0 0 auto;
        }
        canvas {
            display: block;
            width: 220px;
            height: 220px;
            border-radius: 16px;
        }
        .reset-btn {
            flex: 1 1 120px;
            background: #3b6e7a;
            border: none;
            color: white;
            font-size: 1.2rem;
            font-weight: 700;
            padding: 20px 16px;
            border-radius: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 12px 20px #1f5a6390;
            border: 1px solid #ffffff50;
            cursor: pointer;
            transition: all 0.15s;
            -webkit-user-select: none;
        }
        .reset-btn:active {
            transform: scale(0.96);
            box-shadow: 0 6px 12px #16505a;
        }
        .footnote {
            margin-top: 22px;
            color: #1d6873;
            font-size: 0.85rem;
            text-align: center;
            background: #def0f0c0;
            padding: 12px;
            border-radius: 50px;
        }
        hr {
            border: 1px solid #bbd8de;
            margin: 16px 0 10px;
        }
        /* 移动端调整 */
        @media (max-width: 550px) {
            .evaluator { padding: 20px; }
            .type-name { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="evaluator">
        <div class="app-title">
            <h1>🧑‍⚖️ 逾期借款人评估画像工具</h1>
            <span class="badge">期供变更：分类工具</span>
        </div>

        <!-- 打分滑块区域：沟通意愿、还款意愿、还款能力 -->
        <div class="score-panel">
            <div class="score-item">
                <span class="score-label">🗣️ 沟通意愿</span>
                <div class="slider-area">
                    <input type="range" id="commSlider" min="1" max="10" step="1" value="6">
                    <span class="score-number" id="commDisplay">6</span>
                </div>
            </div>
            <div class="score-item">
                <span class="score-label">💰 还款意愿</span>
                <div class="slider-area">
                    <input type="range" id="wishSlider" min="1" max="10" step="1" value="5">
                    <span class="score-number" id="wishDisplay">5</span>
                </div>
            </div>
            <div class="score-item">
                <span class="score-label">📦 还款能力</span>
                <div class="slider-area">
                    <input type="range" id="abilitySlider" min="1" max="10" step="1" value="6">
                    <span class="score-number" id="abilityDisplay">6</span>
                </div>
            </div>
        </div>

        <!-- 动态结果卡片：根据三个分数实时变化 -->
        <div class="result-card" id="resultCard">
            <!-- 内容完全由js动态渲染，避免静态冗余 -->
        </div>

        <!-- 象限简图 + 重置按钮 -->
        <div class="viz-section">
            <div class="canvas-box">
                <canvas id="quadrantCanvas" width="250" height="250"></canvas>
            </div>
            <button class="reset-btn" id="resetButton">
                🔄 重置<br>默认值
            </button>
        </div>
        <div class="footnote">
            ⚡ 沟通意愿、还款意愿以5分为界（≥5高，＜5低）· 还款能力1~10分自动评级
        </div>
        <hr>
        <div style="text-align: center; color: #1b6b78; opacity: 0.8; font-size: 0.9rem;">
            移动滑块 → 实时判断借款人类别及催收策略
        </div>
    </div>

    <script>
        (function() {
            "use strict";

            // ----- 获取DOM元素 -----
            const commSlider = document.getElementById('commSlider');
            const wishSlider = document.getElementById('wishSlider');
            const abilitySlider = document.getElementById('abilitySlider');
            const commDisplay = document.getElementById('commDisplay');
            const wishDisplay = document.getElementById('wishDisplay');
            const abilityDisplay = document.getElementById('abilityDisplay');
            const resultCard = document.getElementById('resultCard');
            const canvas = document.getElementById('quadrantCanvas');
            const ctx = canvas.getContext('2d');

            // ----- 初始化显示数值（与滑块同步）-----
            function updateSliderDisplay() {
                commDisplay.textContent = commSlider.value;
                wishDisplay.textContent = wishSlider.value;
                abilityDisplay.textContent = abilitySlider.value;
            }
            updateSliderDisplay();

            // ----- 根据三个分值判定类型、还款能力评级、策略描述等-----
            function evaluateBorrower(comm, wish, ability) {
                // 意愿高低边界 (5为界，≥5高，<5低)
                const highComm = comm >= 5;
                const highWish = wish >= 5;

                // ----- 1. 象限判定（四类）-----
                let typeKey, typeName, borderColor, bgLightColor, typeIcon;
                if (highComm && highWish) {
                    typeKey = 'active';
                    typeName = '积极配合型';
                    borderColor = '#43a047'; // 绿色
                    bgLightColor = '#e6f5e6';
                    typeIcon = '🤝';
                } else if (!highComm && highWish) {
                    typeKey = 'self';
                    typeName = '自主还款型';
                    borderColor = '#1e88e5'; // 蓝色
                    bgLightColor = '#e3f0ff';
                    typeIcon = '🔇';
                } else if (!highComm && !highWish) {
                    typeKey = 'evade';
                    typeName = '抗拒逃避型';
                    borderColor = '#e53935'; // 红色
                    bgLightColor = '#ffebee';
                    typeIcon = '🚫';
                } else { // 高沟通 + 低还款意愿
                    typeKey = 'delay';
                    typeName = '敷衍拖延型';
                    borderColor = '#fb8c00'; // 橙色
                    bgLightColor = '#fff1df';
                    typeIcon = '⏳';
                }

                // ----- 2. 还款能力评级（1-10分）-----
                let abilityLevel, abilityDesc, abilityColor;
                if (ability >= 8) {
                    abilityLevel = '高';
                    abilityDesc = '还款能力强 · 充裕';
                    abilityColor = '#2e7d5e';
                } else if (ability >= 4) {
                    abilityLevel = '中';
                    abilityDesc = '还款能力一般 · 需协商';
                    abilityColor = '#c07a2c';
                } else {
                    abilityLevel = '低';
                    abilityDesc = '还款能力弱 · 谨慎';
                    abilityColor = '#b13b3b';
                }

                // ----- 3. 针对不同类型 + 能力层级的策略建议 (易懂、接地气)-----
                let strategySuggestion = '';
                if (typeKey === 'active') {
                    strategySuggestion = `✅ 优质客户，配合度高，鼓励现金还款。${abilityLevel}能力：${
                        abilityLevel === '高' ? '提供主动服务，优先安排期供变更，并保持长期联系。' :
                        abilityLevel === '中' ? '安排期供变更，提供一定的情绪价值，并保持长期联系。' :
                         '深度沟通，告知期供变更优势，协助寻找资金来源，避免客户征信失信。'}`;
                } else if (typeKey === 'self') {
                    strategySuggestion = `🔹 不喜欢被打扰，但还款自觉，尝试鼓励现金还款。${abilityLevel}能力：${
                        abilityLevel === '高' ? '平时减少联系，做一次深度有协定的沟通，避免失联。适时介绍期供变更。' :
                        abilityLevel === '中' ? '避免频繁致电，尝试鼓励其沟通和现金还款，适时介绍期供变更。' :
                         '注意了解经济状况变化，提供期供变更选项，保持最低限度但深度沟通和跟进。'}`;
                } else if (typeKey === 'evade') {
                    strategySuggestion = `⚠️ 抵触、失联风险高。${abilityLevel}能力：${
                        abilityLevel === '高' ? '疑似恶意逃债，深度或多次沟通，早做期供变更，并尽量取得理解后保持沟通。' :
                        abilityLevel === '中' ? '表达善意，通过沟通取得信任，考虑上门，争取洽谈期供变更。' :
                         '诉讼时间成本较高时以期供变更为主，经分行评估方可寻求ABS或宽限期。'}`;
                } else { // delay 敷衍拖延
                    strategySuggestion = `⏰ 口头承诺多，无实际还款。${abilityLevel}能力：${
                        abilityLevel === '高' ? '优先表达善意，让选择上门或约面谈，争取达成期供变更并保持联系。' :
                        abilityLevel === '中' ? '做好上门准备，争取达成期供变更并保持联系。' :
                         '诉讼时间成本较高时以期供变更为主，经分行评估方可寻求ABS或宽限期。'}`;
                }

                // 综合描述 (简练)
                const typeSummary = {
                    active: '沟通/还款意愿双高，态度积极',
                    self: '还款意愿强，但沟通冷淡',
                    evade: '两愿均低，抗拒接触',
                    delay: '沟通热情但还款意愿低，习惯拖延'
                };

                return {
                    typeName,
                    borderColor,
                    bgLightColor,
                    typeIcon,
                    abilityLevel,
                    abilityDesc,
                    abilityColor,
                    strategySuggestion,
                    summary: typeSummary[typeKey],
                    typeKey,
                    // 额外用于canvas
                    comm,
                    wish,
                    ability
                };
            }

            // ----- 渲染结果卡片与canvas-----
            function renderAll() {
                // 读取当前分值（整数）
                const comm = parseInt(commSlider.value, 10);
                const wish = parseInt(wishSlider.value, 10);
                const ability = parseInt(abilitySlider.value, 10);

                // 获得评估结果
                const result = evaluateBorrower(comm, wish, ability);

                // 1. 动态更新结果卡片
                resultCard.style.borderLeftColor = result.borderColor;
                resultCard.style.backgroundColor = result.bgLightColor;

                const html = `
                    <div class="type-header">
                        <span class="type-name" style="color: ${result.borderColor};">${result.typeIcon} ${result.typeName}</span>
                        <span class="ability-tag" style="background: ${result.abilityColor};">💪 还款能力 ${result.abilityLevel} · ${ability}分</span>
                    </div>
                    <div class="type-desc">
                        📌 ${result.summary}
                    </div>
                    <div class="strategy-box" style="border-left: 6px solid ${result.borderColor};">
                        <strong>🧠 催收策略建议</strong><br>
                        ${result.strategySuggestion}<br>
                        <span style="display:inline-block; margin-top: 10px; background: white; padding: 6px 16px; border-radius: 40px; color: #0b535f;">✨ 能力得分: ${ability}/10 · 评级${result.abilityLevel}</span>
                    </div>
                `;
                resultCard.innerHTML = html;

                // 2. 绘制象限坐标图（沟通意愿X，还款意愿Y）
                drawQuadrant(comm, wish);
            }

            // ----- 绘制canvas坐标图（0-10网格，带象限分割和动态点）-----
            function drawQuadrant(commX, wishY) {
                const w = canvas.width;     // 250px
                const h = canvas.height;    // 250px
                const padding = 32;          // 边距
                const axisX = padding;
                const axisY = h - padding;
                const drawWidth = w - 2 * padding;
                const drawHeight = h - 2 * padding;

                // 清空画布
                ctx.clearRect(0, 0, w, h);

                // ----- 背景、网格 -----
                ctx.fillStyle = '#fefefd';
                ctx.fillRect(0, 0, w, h);
                
                // 浅灰网格线 (1单位间隔)
                ctx.lineWidth = 0.6;
                ctx.strokeStyle = '#c9dde3';
                ctx.beginPath();
                for (let i = 0; i <= 10; i++) {
                    const x = axisX + (i / 10) * drawWidth;
                    const y = axisY - (i / 10) * drawHeight;
                    // 竖线
                    ctx.moveTo(x, axisY);
                    ctx.lineTo(x, axisY - drawHeight);
                    // 横线
                    ctx.moveTo(axisX, y);
                    ctx.lineTo(axisX + drawWidth, y);
                }
                ctx.stroke();

                // ----- 坐标轴（黑色加粗）-----
                ctx.beginPath();
                ctx.lineWidth = 2.2;
                ctx.strokeStyle = '#1a4c57';
                // X轴
                ctx.moveTo(axisX, axisY);
                ctx.lineTo(axisX + drawWidth, axisY);
                // Y轴
                ctx.moveTo(axisX, axisY);
                ctx.lineTo(axisX, axisY - drawHeight);
                ctx.stroke();

                // 轴线箭头
                ctx.fillStyle = '#1a4c57';
                // X箭头
                ctx.beginPath();
                ctx.moveTo(axisX + drawWidth - 8, axisY - 6);
                ctx.lineTo(axisX + drawWidth, axisY);
                ctx.lineTo(axisX + drawWidth - 8, axisY + 6);
                ctx.fill();
                // Y箭头
                ctx.beginPath();
                ctx.moveTo(axisX - 6, axisY - drawHeight + 8);
                ctx.lineTo(axisX, axisY - drawHeight);
                ctx.lineTo(axisX + 6, axisY - drawHeight + 8);
                ctx.fill();

                // ----- 标注刻度文字（只标0,5,10）-----
                ctx.font = '12px "Segoe UI", "PingFang SC", sans-serif';
                ctx.fillStyle = '#185b66';
                // X轴刻度
                ctx.fillText('0', axisX - 12, axisY - 8);
                ctx.fillText('5', axisX + drawWidth * 0.5 - 10, axisY - 18);
                ctx.fillText('10', axisX + drawWidth - 26, axisY - 18);
                // Y轴刻度
                ctx.fillText('0', axisX - 28, axisY + 5);
                ctx.fillText('5', axisX - 34, axisY - drawHeight * 0.5 - 6);
                ctx.fillText('10', axisX - 38, axisY - drawHeight + 2);

                // ----- 画两条分割线 (x=5, y=5) 更明显-----
                ctx.beginPath();
                ctx.lineWidth = 2;
                ctx.strokeStyle = '#2e8291';
                ctx.setLineDash([5, 5]);
                // x=5 竖虚线
                const x5 = axisX + (5 / 10) * drawWidth;
                ctx.moveTo(x5, axisY);
                ctx.lineTo(x5, axisY - drawHeight);
                // y=5 横虚线
                const y5 = axisY - (5 / 10) * drawHeight;
                ctx.moveTo(axisX, y5);
                ctx.lineTo(axisX + drawWidth, y5);
                ctx.stroke();
                ctx.setLineDash([]); // 重置

                // ----- 标注象限名称（简洁）-----
                ctx.font = 'bold 11px "Segoe UI", "PingFang SC"';
                ctx.fillStyle = '#2d6b75';
                // 右上（积极配合）
                ctx.fillText('积极配合', axisX + drawWidth * 0.6, axisY - drawHeight * 0.2);
                // 左上（自主还款）
                ctx.fillText('自主还款', axisX + drawWidth * 0.1, axisY - drawHeight * 0.2);
                // 左下（抗拒逃避）
                ctx.fillText('抗拒逃避', axisX + drawWidth * 0.1, axisY - drawHeight * 0.8);
                // 右下（敷衍拖延）
                ctx.fillText('敷衍拖延', axisX + drawWidth * 0.6, axisY - drawHeight * 0.8);

                // ----- 绘制当前借款人的点（沟通，还款意愿）-----
                const pointX = axisX + (commX / 10) * drawWidth;
                const pointY = axisY - (wishY / 10) * drawHeight;  // 注意Y翻转

                // 外发光效果
                ctx.shadowColor = 'rgba(0,150,160,0.7)';
                ctx.shadowBlur = 12;
                ctx.beginPath();
                ctx.fillStyle = '#b3382c';
                ctx.arc(pointX, pointY, 9, 0, 2 * Math.PI);
                ctx.fill();
                ctx.shadowBlur = 0;
                // 白色内圈
                ctx.beginPath();
                ctx.fillStyle = '#ff6b5c';
                ctx.arc(pointX, pointY, 7, 0, 2 * Math.PI);
                ctx.fill();
                ctx.beginPath();
                ctx.fillStyle = 'white';
                ctx.arc(pointX, pointY, 4, 0, 2 * Math.PI);
                ctx.fill();

                // 增加坐标标签
                ctx.font = 'bold 12px "Segoe UI"';
                ctx.fillStyle = '#c2422b';
                ctx.shadowBlur = 4;
                ctx.shadowColor = 'white';
                ctx.fillText(`(${commX},${wishY})`, pointX + 15, pointY - 15);
                ctx.shadowBlur = 0;
            }

            // ----- 重置到默认值：沟通6，还款5，能力6-----
            function resetToDefault() {
                commSlider.value = 6;
                wishSlider.value = 5;
                abilitySlider.value = 6;
                updateSliderDisplay();
                renderAll();
            }

            // ----- 监听滑块事件-----
            function handleSliderChange() {
                updateSliderDisplay();
                renderAll();
            }

            commSlider.addEventListener('input', handleSliderChange);
            wishSlider.addEventListener('input', handleSliderChange);
            abilitySlider.addEventListener('input', handleSliderChange);

            // 重置按钮监听
            const resetBtn = document.getElementById('resetButton');
            resetBtn.addEventListener('click', function(e) {
                e.preventDefault();
                resetToDefault();
            });

            // 页面加载渲染初始状态
            renderAll();

            // 微信触摸优化：滑块不触发页面滚动（不影响）
            const sliders = [commSlider, wishSlider, abilitySlider];
            sliders.forEach(s => {
                s.addEventListener('touchstart', (e) => { e.stopPropagation(); });
            });

            // 适配canvas在移动设备上的清晰显示（已设置宽高250px，css限定220x220可接受）
        })();
    </script>
</body>
</html>